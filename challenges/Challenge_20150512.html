<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>.NET Challenge for May 12, 2015
</title>
  <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">
  <link href="/styles.css" rel="stylesheet">
</head>
<body>
<a href="https://github.com/mandest/NerderyDotNetChallenges"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://camo.githubusercontent.com/82b228a3648bf44fc1163ef44c62fcc60081495e/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_red_aa0000.png"></a>
  <div class="container">
    <div class="masthead">
      <ul class="nav nav-pills pull-right">
        <li><a href="https://dotnet.nerderylabs.com/">Challenges</a></li>
      </ul>
      <h3><a href="/" class="muted">Nerdery .NET Challenges in </a>F#</h3>
    </div>
    <div class="row">
      <div class="span9">
        <div class="markdown-body">
          <h1>.NET Challenge for May 12, 2015</h1>

<h2>Prompt</h2>

<p>Last week I didn’t specify a format for my challenge solutions that was a mistake. The official format for submissions is a Github Gist. Please post a link to your submission in a comment on this post.</p>

<p>For this week’s challenge, create a function that will accept a dictionary with the following keys and values:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip" lang="json">{
  "author_name": "Robert Jordan",
  "book_title": "Knife of Dreams",
  "series": "The Wheel of Time, Book 11",
  "publisher": "Tor Fantasy",
  "published_date": "November 28, 2006"
}
</pre></td></tr></table>

<p>The function should return a query string that meets the following criteria:</p>

<ul>
<li>It includes all of the values from the dictionary as key value pairs</li>
<li>It also includes a <code>timestamp</code> parameter that is the milliseconds since the Unix epoch</li>
<li>It also includes a <code>signature</code> parameter. The signature parameter should be generated by:
<ul>
<li>Assembling the query string with each key in alphabetical order (e.g. <code>author_name=Robert%20Jordan&amp;book_title=Knife%20of%20Dreams&amp;published_date=November%2028%2C%202006&amp;publisher=Tor%20Fantasy&amp;series=The%20Wheel%20of%20Time%2C%20Book%2011&amp;timestamp=0</code>)</li>
<li>Append the following string <code>"1234MySuperSecretKey4321"</code></li>
<li>Generate a hash from the string using the SHA-1 hash function. The resulting hash is the signature.</li>
</ul></li>
</ul>

<h2>Coding</h2>

<h3>Step One: Let's setup inputs</h3>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
<span class="l">9: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">input</span> <span class="o">=</span> (<span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="f">sort</span> [
    <span class="s">&quot;author_name&quot;</span>, <span class="s">&quot;Robert Jordan&quot;</span>;
    <span class="s">&quot;book_title&quot;</span>, <span class="s">&quot;Knife of Dreams&quot;</span>;
    <span class="s">&quot;series&quot;</span>, <span class="s">&quot;The Wheel of Time, Book 11&quot;</span>;
    <span class="s">&quot;publisher&quot;</span>, <span class="s">&quot;Tor Fantasy&quot;</span>;
    <span class="s">&quot;published_date&quot;</span>, <span class="s">&quot;November 28, 2006&quot;</span>;
    <span class="s">&quot;timestamp&quot;</span>, (<span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="t">DateTime</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="i">Now</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs4', 7)" onmouseover="showTip(event, 'fs4', 7)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs5', 8)" onmouseover="showTip(event, 'fs5', 8)" class="t">DateTime</span>(<span class="n">0</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs7', 9)" onmouseover="showTip(event, 'fs7', 9)" class="f">int64</span>))<span class="o">.</span><span class="i">TotalMilliseconds</span><span class="o">.</span><span class="f">ToString</span>()
])
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs8', 10)" onmouseover="showTip(event, 'fs8', 10)" class="i">secret</span> <span class="o">=</span> <span class="s">&quot;1234MySuperSecretKey4321&quot;</span>
</pre>
</td>
</tr>
</table>

<h3>Step Two: Shorthand methods because legibility</h3>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs9', 11)" onmouseover="showTip(event, 'fs9', 11)" class="f">encode</span> (<span onmouseout="hideTip(event, 'fs10', 12)" onmouseover="showTip(event, 'fs10', 12)" class="i">x</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs11', 13)" onmouseover="showTip(event, 'fs11', 13)" class="t">string</span>) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs4', 14)" onmouseover="showTip(event, 'fs4', 14)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 15)" onmouseover="showTip(event, 'fs12', 15)" class="i">Web</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 16)" onmouseover="showTip(event, 'fs13', 16)" class="t">HttpUtility</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs14', 17)" onmouseover="showTip(event, 'fs14', 17)" class="f">UrlEncode</span>(<span onmouseout="hideTip(event, 'fs10', 18)" onmouseover="showTip(event, 'fs10', 18)" class="i">x</span>)<span class="o">.</span><span class="f">Replace</span>(<span class="s">&quot;+&quot;</span>, <span class="s">&quot;%20&quot;</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs15', 19)" onmouseover="showTip(event, 'fs15', 19)" class="f">hash</span> (<span onmouseout="hideTip(event, 'fs16', 20)" onmouseover="showTip(event, 'fs16', 20)" class="i">x</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs4', 21)" onmouseover="showTip(event, 'fs4', 21)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 22)" onmouseover="showTip(event, 'fs17', 22)" class="t">Byte</span>[]) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs4', 23)" onmouseover="showTip(event, 'fs4', 23)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 24)" onmouseover="showTip(event, 'fs18', 24)" class="i">Security</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs19', 25)" onmouseover="showTip(event, 'fs19', 25)" class="i">Cryptography</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 26)" onmouseover="showTip(event, 'fs20', 26)" class="t">SHA1</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs21', 27)" onmouseover="showTip(event, 'fs21', 27)" class="f">Create</span>()<span class="o">.</span><span class="f">ComputeHash</span>(<span onmouseout="hideTip(event, 'fs16', 28)" onmouseover="showTip(event, 'fs16', 28)" class="i">x</span>)
</pre>
</td>
</tr>
</table>

<h3>Step Three: Do the thing</h3>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
<span class="l">9: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span onmouseout="hideTip(event, 'fs1', 29)" onmouseover="showTip(event, 'fs1', 29)" class="i">input</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs2', 30)" onmouseover="showTip(event, 'fs2', 30)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 31)" onmouseover="showTip(event, 'fs22', 31)" class="f">map</span> (<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs23', 32)" onmouseover="showTip(event, 'fs23', 32)" class="i">k</span>, <span onmouseout="hideTip(event, 'fs24', 33)" onmouseover="showTip(event, 'fs24', 33)" class="i">v</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs25', 34)" onmouseover="showTip(event, 'fs25', 34)" class="f">sprintf</span> <span class="s">&quot;</span><span class="pf">%s</span><span class="s">=</span><span class="pf">%s</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs23', 35)" onmouseover="showTip(event, 'fs23', 35)" class="i">k</span> (<span onmouseout="hideTip(event, 'fs9', 36)" onmouseover="showTip(event, 'fs9', 36)" class="f">encode</span> <span onmouseout="hideTip(event, 'fs24', 37)" onmouseover="showTip(event, 'fs24', 37)" class="i">v</span>)) <span class="c">// Turn tuples into A=B strings</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs26', 38)" onmouseover="showTip(event, 'fs26', 38)" class="t">String</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs27', 39)" onmouseover="showTip(event, 'fs27', 39)" class="f">concat</span> <span class="s">&quot;&amp;&quot;</span> <span class="c">// Concatenate those strings using &amp;</span>
    <span class="o">|&gt;</span> <span class="k">fun</span> <span onmouseout="hideTip(event, 'fs28', 40)" onmouseover="showTip(event, 'fs28', 40)" class="i">s</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs25', 41)" onmouseover="showTip(event, 'fs25', 41)" class="f">sprintf</span> <span class="s">&quot;</span><span class="pf">%s</span><span class="s"></span><span class="pf">%s</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs28', 42)" onmouseover="showTip(event, 'fs28', 42)" class="i">s</span> <span onmouseout="hideTip(event, 'fs8', 43)" onmouseover="showTip(event, 'fs8', 43)" class="i">secret</span> <span class="c">// Append secret</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs4', 44)" onmouseover="showTip(event, 'fs4', 44)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 45)" onmouseover="showTip(event, 'fs29', 45)" class="i">Text</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs30', 46)" onmouseover="showTip(event, 'fs30', 46)" class="t">Encoding</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs31', 47)" onmouseover="showTip(event, 'fs31', 47)" class="i">UTF8</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 48)" onmouseover="showTip(event, 'fs32', 48)" class="f">GetBytes</span> <span class="c">// Convert to byte array (UTF8)</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs15', 49)" onmouseover="showTip(event, 'fs15', 49)" class="f">hash</span> <span class="c">// And finally, compute the hash!</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs2', 50)" onmouseover="showTip(event, 'fs2', 50)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 51)" onmouseover="showTip(event, 'fs22', 51)" class="f">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs33', 52)" onmouseover="showTip(event, 'fs33', 52)" class="i">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs33', 53)" onmouseover="showTip(event, 'fs33', 53)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs34', 54)" onmouseover="showTip(event, 'fs34', 54)" class="f">ToString</span>(<span class="s">&quot;x2&quot;</span>)) <span class="c">// Convert bytes to hex codes</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs26', 55)" onmouseover="showTip(event, 'fs26', 55)" class="t">String</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs27', 56)" onmouseover="showTip(event, 'fs27', 56)" class="f">concat</span> <span class="s">&quot;&quot;</span> <span class="c">// Join them</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 57)" onmouseover="showTip(event, 'fs35', 57)" class="f">printfn</span> <span class="s">&quot;</span><span class="pf">%s</span><span class="s">&quot;</span> <span class="c">// Display them</span>
</pre>
</td>
</tr>
</table>

<h2>Result</h2>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip" lang="f#">a3d3fe482447bb61c3f9739e921032ea4040d77b
</pre></td></tr></table>

        </div>
      </div>
      <div class="span3">
        <ul class="nav nav-list">
          <li class="nav-header">Issues</li>
          <li><a href="/">Home</a></li>
          <li class="divider"></li>
          <li><a href="/issue-1">Issue 1 - Fibonacci</a></li>
          <li><a href="/issue-2">Issue 2 - Hashing</a></li>
        </ul>
      </div>
    </div>
  </div>
</body>
</html>