<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Setup
</title>
  <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">
  <link href="/styles.css" rel="stylesheet">
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-23038189-2', 'auto');
    ga('send', 'pageview');

  </script>
</head>
<body>
<a href="https://github.com/mandest/NerderyDotNetChallenges"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://camo.githubusercontent.com/82b228a3648bf44fc1163ef44c62fcc60081495e/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_red_aa0000.png"></a>
  <div class="container">
    <div class="masthead">
      <ul class="nav nav-pills pull-right">
        <li><a href="https://dotnet.nerderylabs.com/">.NET Challenges</a></li>
      </ul>
      <h3><a href="/"><span class="muted">Nerdery .NET Challenges in </span>F#</a></h3>
    </div>
    <div class="row">
      <div class="span9">
        <div class="markdown-body">
          <h1>Setup</h1>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="prep">#load</span> <span class="s">&quot;../packages/FsLab/FsLab.fsx&quot;</span>
</pre>
</td>
</tr>
</table>

<p>We'll use 3 parts of FSLab:
  1. FSharp.Data for data querying
  2. Deedle for data processing and manipulation
  3. XPlot for graphing our results</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">System</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">FSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">Data</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 4)" onmouseover="showTip(event, 'fs2', 4)" class="i">FSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 5)" onmouseover="showTip(event, 'fs3', 5)" class="i">Data</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs4', 6)" onmouseover="showTip(event, 'fs4', 6)" class="i">Runtime</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs5', 7)" onmouseover="showTip(event, 'fs5', 7)" class="i">BaseTypes</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs6', 8)" onmouseover="showTip(event, 'fs6', 8)" class="i">Deedle</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs7', 9)" onmouseover="showTip(event, 'fs7', 9)" class="i">XPlot</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 10)" onmouseover="showTip(event, 'fs8', 10)" class="i">GoogleCharts</span>
</pre>
</td>
</tr>
</table>

<p>Set some constants up.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
<span class="l">9: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs9', 11)" onmouseover="showTip(event, 'fs9', 11)" class="i">baseUrl</span> <span class="o">=</span> <span class="s">&quot;http://api.nytimes.com/svc/elections/us/v3/finances/2012&quot;</span>
<span class="c">// let apiKey = &quot;3938ef998ede56fd9ba55e3b2ccefa37:16:72625105&quot;</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs10', 12)" onmouseover="showTip(event, 'fs10', 12)" class="i">apiKey</span> <span class="o">=</span> <span class="s">&quot;316ed00bf4b54d8ba9a625e84f78d80a:12:72637909&quot;</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs11', 13)" onmouseover="showTip(event, 'fs11', 13)" class="i">states</span> <span class="o">=</span> [<span class="s">&quot;AL&quot;</span>;<span class="s">&quot;AK&quot;</span>;<span class="s">&quot;AZ&quot;</span>;<span class="s">&quot;AR&quot;</span>;<span class="s">&quot;CA&quot;</span>;<span class="s">&quot;CO&quot;</span>;<span class="s">&quot;CT&quot;</span>;<span class="s">&quot;DE&quot;</span>;<span class="s">&quot;FL&quot;</span>;<span class="s">&quot;GA&quot;</span>;<span class="s">&quot;HI&quot;</span>;
              <span class="s">&quot;ID&quot;</span>;<span class="s">&quot;IL&quot;</span>;<span class="s">&quot;IN&quot;</span>;<span class="s">&quot;IA&quot;</span>;<span class="s">&quot;KS&quot;</span>;<span class="s">&quot;KY&quot;</span>;<span class="s">&quot;LA&quot;</span>;<span class="s">&quot;ME&quot;</span>;<span class="s">&quot;MD&quot;</span>;<span class="s">&quot;MA&quot;</span>;<span class="s">&quot;MI&quot;</span>;
              <span class="s">&quot;MN&quot;</span>;<span class="s">&quot;MS&quot;</span>;<span class="s">&quot;MO&quot;</span>;<span class="s">&quot;MT&quot;</span>;<span class="s">&quot;NE&quot;</span>;<span class="s">&quot;NV&quot;</span>;<span class="s">&quot;NH&quot;</span>;<span class="s">&quot;NJ&quot;</span>;<span class="s">&quot;NM&quot;</span>;<span class="s">&quot;NY&quot;</span>;<span class="s">&quot;NC&quot;</span>;
              <span class="s">&quot;ND&quot;</span>;<span class="s">&quot;OH&quot;</span>;<span class="s">&quot;OK&quot;</span>;<span class="s">&quot;OR&quot;</span>;<span class="s">&quot;PA&quot;</span>;<span class="s">&quot;RI&quot;</span>;<span class="s">&quot;SC&quot;</span>;<span class="s">&quot;SD&quot;</span>;<span class="s">&quot;TN&quot;</span>;<span class="s">&quot;TX&quot;</span>;<span class="s">&quot;UT&quot;</span>;
              <span class="s">&quot;VT&quot;</span>;<span class="s">&quot;VA&quot;</span>;<span class="s">&quot;WA&quot;</span>;<span class="s">&quot;WV&quot;</span>;<span class="s">&quot;WI&quot;</span>;<span class="s">&quot;WY&quot;</span>]
</pre>
</td>
</tr>
</table>

<h1>Type providers</h1>

<p>Type providers are super-classes that allow types to be generated (and compiled into CLI) using dynamic data.  Examples of data sources can be SQL databases, JSON, or CSV files.  Type providers can be thought of as programattic T4 templates, without the double-compilation overhead that T4s have.</p>

<p>We'll setup 2 schemas (types) to query against: <strong>broad</strong> candidate information, and <strong>detailed</strong> candidate information.
Doing this gives strongly typed intellisense-capable classes which can load information directly from the API.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> [&lt;<span onmouseout="hideTip(event, 'fs12', 14)" onmouseover="showTip(event, 'fs12', 14)" class="t">Literal</span>&gt;] <span onmouseout="hideTip(event, 'fs13', 15)" onmouseover="showTip(event, 'fs13', 15)" class="i">candidateUrl</span> <span class="o">=</span> <span class="s">&quot;http://api.nytimes.com/svc/elections/us/v3/finances/\</span>
<span class="s">2012/seats/MN.json?api-key=316ed00bf4b54d8ba9a625e84f78d80a:12:72637909&quot;</span>
<span class="k">let</span> [&lt;<span onmouseout="hideTip(event, 'fs12', 16)" onmouseover="showTip(event, 'fs12', 16)" class="t">Literal</span>&gt;] <span onmouseout="hideTip(event, 'fs14', 17)" onmouseover="showTip(event, 'fs14', 17)" class="i">detailsUrl</span> <span class="o">=</span> <span class="s">&quot;http://api.nytimes.com/svc/elections/us/v3/finances/\</span>
<span class="s">2012/candidates/H2MN07097.json?api-key=316ed00bf4b54d8ba9a625e84f78d80a:12:72637909&quot;</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs15', 18)" onmouseover="showTip(event, 'fs15', 18)" class="t">candidateCollection</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs16', 19)" onmouseover="showTip(event, 'fs16', 19)" class="t">JsonProvider</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs13', 20)" onmouseover="showTip(event, 'fs13', 20)" class="i">candidateUrl</span><span class="o">&gt;</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs17', 21)" onmouseover="showTip(event, 'fs17', 21)" class="t">candidateDetailsCollection</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs16', 22)" onmouseover="showTip(event, 'fs16', 22)" class="t">JsonProvider</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs14', 23)" onmouseover="showTip(event, 'fs14', 23)" class="i">detailsUrl</span><span class="o">&gt;</span>
</pre>
</td>
</tr>
</table>

<h1>Data querying</h1>

<p>Next, let's find all candidates in all states.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs18', 24)" onmouseover="showTip(event, 'fs18', 24)" class="i">stateCandidates</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs11', 25)" onmouseover="showTip(event, 'fs11', 25)" class="i">states</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 26)" onmouseover="showTip(event, 'fs19', 26)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 27)" onmouseover="showTip(event, 'fs20', 27)" class="f">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs21', 28)" onmouseover="showTip(event, 'fs21', 28)" class="i">s</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs22', 29)" onmouseover="showTip(event, 'fs22', 29)" class="f">sprintf</span> <span class="s">&quot;</span><span class="pf">%s</span><span class="s">/seats/</span><span class="pf">%s</span><span class="s">.json?api-key=</span><span class="pf">%s</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs9', 30)" onmouseover="showTip(event, 'fs9', 30)" class="i">baseUrl</span> <span onmouseout="hideTip(event, 'fs21', 31)" onmouseover="showTip(event, 'fs21', 31)" class="i">s</span> <span onmouseout="hideTip(event, 'fs10', 32)" onmouseover="showTip(event, 'fs10', 32)" class="i">apiKey</span>)
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 33)" onmouseover="showTip(event, 'fs19', 33)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 34)" onmouseover="showTip(event, 'fs20', 34)" class="f">map</span> <span onmouseout="hideTip(event, 'fs15', 35)" onmouseover="showTip(event, 'fs15', 35)" class="t">candidateCollection</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 36)" onmouseover="showTip(event, 'fs23', 36)" class="f">Load</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 37)" onmouseover="showTip(event, 'fs19', 37)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs24', 38)" onmouseover="showTip(event, 'fs24', 38)" class="f">toList</span>
</pre>
</td>
</tr>
</table>

<p>Then get details for everyone one of these candidates.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs25', 39)" onmouseover="showTip(event, 'fs25', 39)" class="i">candidateDetails</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs18', 40)" onmouseover="showTip(event, 'fs18', 40)" class="i">stateCandidates</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 41)" onmouseover="showTip(event, 'fs19', 41)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 42)" onmouseover="showTip(event, 'fs26', 42)" class="f">collect</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs27', 43)" onmouseover="showTip(event, 'fs27', 43)" class="i">c</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs27', 44)" onmouseover="showTip(event, 'fs27', 44)" class="i">c</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs28', 45)" onmouseover="showTip(event, 'fs28', 45)" class="i">Results</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 46)" onmouseover="showTip(event, 'fs19', 46)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 47)" onmouseover="showTip(event, 'fs20', 47)" class="f">map</span>(<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs29', 48)" onmouseover="showTip(event, 'fs29', 48)" class="i">r</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs29', 49)" onmouseover="showTip(event, 'fs29', 49)" class="i">r</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs30', 50)" onmouseover="showTip(event, 'fs30', 50)" class="i">Candidate</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs31', 51)" onmouseover="showTip(event, 'fs31', 51)" class="i">Id</span>))
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 52)" onmouseover="showTip(event, 'fs19', 52)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 53)" onmouseover="showTip(event, 'fs20', 53)" class="f">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs21', 54)" onmouseover="showTip(event, 'fs21', 54)" class="i">s</span> <span class="k">-&gt;</span>
      <span onmouseout="hideTip(event, 'fs22', 55)" onmouseover="showTip(event, 'fs22', 55)" class="f">sprintf</span> <span class="s">&quot;</span><span class="pf">%s</span><span class="s">/candidates/</span><span class="pf">%s</span><span class="s">.json?api-key=</span><span class="pf">%s</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs9', 56)" onmouseover="showTip(event, 'fs9', 56)" class="i">baseUrl</span> <span onmouseout="hideTip(event, 'fs21', 57)" onmouseover="showTip(event, 'fs21', 57)" class="i">s</span> <span onmouseout="hideTip(event, 'fs10', 58)" onmouseover="showTip(event, 'fs10', 58)" class="i">apiKey</span>)
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 59)" onmouseover="showTip(event, 'fs19', 59)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 60)" onmouseover="showTip(event, 'fs20', 60)" class="f">map</span> <span onmouseout="hideTip(event, 'fs17', 61)" onmouseover="showTip(event, 'fs17', 61)" class="t">candidateDetailsCollection</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 62)" onmouseover="showTip(event, 'fs23', 62)" class="f">Load</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 63)" onmouseover="showTip(event, 'fs19', 63)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs24', 64)" onmouseover="showTip(event, 'fs24', 64)" class="f">toList</span>
</pre>
</td>
</tr>
</table>

<p>Deedle doesn't support expanding JsonValue types by default, so we'll add that into the library.  This is somewhat superfluous, as it's configuring Deedle.  Feel free to peruse if interested.  An issue was opened <a href="https://github.com/fslaborg/FsLab/issues/14">here</a> for those with interest.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs32', 65)" onmouseover="showTip(event, 'fs32', 65)" class="f">expander</span> <span onmouseout="hideTip(event, 'fs33', 66)" onmouseover="showTip(event, 'fs33', 66)" class="i">key</span> <span onmouseout="hideTip(event, 'fs34', 67)" onmouseover="showTip(event, 'fs34', 67)" class="i">value</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs35', 68)" onmouseover="showTip(event, 'fs35', 68)" class="i">seq</span> {
        <span class="k">match</span> <span onmouseout="hideTip(event, 'fs34', 69)" onmouseover="showTip(event, 'fs34', 69)" class="i">value</span> <span class="k">with</span>
        | <span onmouseout="hideTip(event, 'fs36', 70)" onmouseover="showTip(event, 'fs36', 70)" class="t">JsonValue</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs37', 71)" onmouseover="showTip(event, 'fs37', 71)" class="p">String</span>  (<span onmouseout="hideTip(event, 'fs21', 72)" onmouseover="showTip(event, 'fs21', 72)" class="i">s</span>) <span class="k">-&gt;</span> <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs33', 73)" onmouseover="showTip(event, 'fs33', 73)" class="i">key</span>,<span onmouseout="hideTip(event, 'fs38', 74)" onmouseover="showTip(event, 'fs38', 74)" class="i">typeof</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs39', 75)" onmouseover="showTip(event, 'fs39', 75)" class="t">string</span><span class="o">&gt;</span>,<span onmouseout="hideTip(event, 'fs40', 76)" onmouseover="showTip(event, 'fs40', 76)" class="f">box</span> <span onmouseout="hideTip(event, 'fs21', 77)" onmouseover="showTip(event, 'fs21', 77)" class="i">s</span>
        | <span onmouseout="hideTip(event, 'fs36', 78)" onmouseover="showTip(event, 'fs36', 78)" class="t">JsonValue</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs41', 79)" onmouseover="showTip(event, 'fs41', 79)" class="p">Boolean</span> (<span onmouseout="hideTip(event, 'fs42', 80)" onmouseover="showTip(event, 'fs42', 80)" class="i">b</span>) <span class="k">-&gt;</span> <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs33', 81)" onmouseover="showTip(event, 'fs33', 81)" class="i">key</span>,<span onmouseout="hideTip(event, 'fs38', 82)" onmouseover="showTip(event, 'fs38', 82)" class="i">typeof</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs43', 83)" onmouseover="showTip(event, 'fs43', 83)" class="t">bool</span><span class="o">&gt;</span>,<span onmouseout="hideTip(event, 'fs40', 84)" onmouseover="showTip(event, 'fs40', 84)" class="f">box</span> <span onmouseout="hideTip(event, 'fs42', 85)" onmouseover="showTip(event, 'fs42', 85)" class="i">b</span>
        | <span onmouseout="hideTip(event, 'fs36', 86)" onmouseover="showTip(event, 'fs36', 86)" class="t">JsonValue</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs44', 87)" onmouseover="showTip(event, 'fs44', 87)" class="p">Float</span>   (<span onmouseout="hideTip(event, 'fs45', 88)" onmouseover="showTip(event, 'fs45', 88)" class="i">f</span>) <span class="k">-&gt;</span> <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs33', 89)" onmouseover="showTip(event, 'fs33', 89)" class="i">key</span>,<span onmouseout="hideTip(event, 'fs38', 90)" onmouseover="showTip(event, 'fs38', 90)" class="i">typeof</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs46', 91)" onmouseover="showTip(event, 'fs46', 91)" class="t">float</span><span class="o">&gt;</span>,<span onmouseout="hideTip(event, 'fs40', 92)" onmouseover="showTip(event, 'fs40', 92)" class="f">box</span> <span onmouseout="hideTip(event, 'fs45', 93)" onmouseover="showTip(event, 'fs45', 93)" class="i">f</span>
        | <span onmouseout="hideTip(event, 'fs36', 94)" onmouseover="showTip(event, 'fs36', 94)" class="t">JsonValue</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs47', 95)" onmouseover="showTip(event, 'fs47', 95)" class="p">Null</span>    (_) <span class="k">-&gt;</span> <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs33', 96)" onmouseover="showTip(event, 'fs33', 96)" class="i">key</span>,<span onmouseout="hideTip(event, 'fs38', 97)" onmouseover="showTip(event, 'fs38', 97)" class="i">typeof</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs48', 98)" onmouseover="showTip(event, 'fs48', 98)" class="t">obj</span><span class="o">&gt;</span>,<span onmouseout="hideTip(event, 'fs40', 99)" onmouseover="showTip(event, 'fs40', 99)" class="f">box</span> ()
        | <span onmouseout="hideTip(event, 'fs36', 100)" onmouseover="showTip(event, 'fs36', 100)" class="t">JsonValue</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs49', 101)" onmouseover="showTip(event, 'fs49', 101)" class="p">Number</span>  (<span onmouseout="hideTip(event, 'fs50', 102)" onmouseover="showTip(event, 'fs50', 102)" class="i">n</span>) <span class="k">-&gt;</span> <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs33', 103)" onmouseover="showTip(event, 'fs33', 103)" class="i">key</span>,<span onmouseout="hideTip(event, 'fs38', 104)" onmouseover="showTip(event, 'fs38', 104)" class="i">typeof</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs51', 105)" onmouseover="showTip(event, 'fs51', 105)" class="t">decimal</span><span class="o">&gt;</span>,<span onmouseout="hideTip(event, 'fs40', 106)" onmouseover="showTip(event, 'fs40', 106)" class="f">box</span> <span onmouseout="hideTip(event, 'fs50', 107)" onmouseover="showTip(event, 'fs50', 107)" class="i">n</span>
        | <span onmouseout="hideTip(event, 'fs36', 108)" onmouseover="showTip(event, 'fs36', 108)" class="t">JsonValue</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs52', 109)" onmouseover="showTip(event, 'fs52', 109)" class="p">Record</span>  (<span onmouseout="hideTip(event, 'fs53', 110)" onmouseover="showTip(event, 'fs53', 110)" class="i">r</span>) <span class="k">-&gt;</span> <span class="k">yield!</span> <span onmouseout="hideTip(event, 'fs53', 111)" onmouseover="showTip(event, 'fs53', 111)" class="i">r</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 112)" onmouseover="showTip(event, 'fs19', 112)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 113)" onmouseover="showTip(event, 'fs26', 113)" class="f">collect</span> ((<span class="o">&lt;||</span>)<span onmouseout="hideTip(event, 'fs32', 114)" onmouseover="showTip(event, 'fs32', 114)" class="f">expander</span>)
        | <span onmouseout="hideTip(event, 'fs36', 115)" onmouseover="showTip(event, 'fs36', 115)" class="t">JsonValue</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs54', 116)" onmouseover="showTip(event, 'fs54', 116)" class="p">Array</span>   (<span onmouseout="hideTip(event, 'fs55', 117)" onmouseover="showTip(event, 'fs55', 117)" class="i">a</span>) <span class="k">-&gt;</span>
            <span class="k">yield!</span> <span onmouseout="hideTip(event, 'fs55', 118)" onmouseover="showTip(event, 'fs55', 118)" class="i">a</span>
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 119)" onmouseover="showTip(event, 'fs19', 119)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 120)" onmouseover="showTip(event, 'fs26', 120)" class="f">collect</span> (<span onmouseout="hideTip(event, 'fs32', 121)" onmouseover="showTip(event, 'fs32', 121)" class="f">expander</span> <span class="s">&quot;arrayItem&quot;</span>)
    }

<span onmouseout="hideTip(event, 'fs56', 122)" onmouseover="showTip(event, 'fs56', 122)" class="t">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs57', 123)" onmouseover="showTip(event, 'fs57', 123)" class="i">CustomExpanders</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs58', 124)" onmouseover="showTip(event, 'fs58', 124)" class="f">Add</span>(<span onmouseout="hideTip(event, 'fs38', 125)" onmouseover="showTip(event, 'fs38', 125)" class="i">typeof</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs59', 126)" onmouseover="showTip(event, 'fs59', 126)" class="t">JsonDocument</span><span class="o">&gt;</span>, <span class="k">fun</span> <span onmouseout="hideTip(event, 'fs60', 127)" onmouseover="showTip(event, 'fs60', 127)" class="i">o</span> <span class="k">-&gt;</span> (<span onmouseout="hideTip(event, 'fs60', 128)" onmouseover="showTip(event, 'fs60', 128)" class="i">o</span> <span class="o">:?&gt;</span> <span onmouseout="hideTip(event, 'fs59', 129)" onmouseover="showTip(event, 'fs59', 129)" class="t">JsonDocument</span>)<span class="o">.</span><span onmouseout="hideTip(event, 'fs36', 130)" onmouseover="showTip(event, 'fs36', 130)" class="i">JsonValue</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs32', 131)" onmouseover="showTip(event, 'fs32', 131)" class="f">expander</span> <span class="s">&quot;root&quot;</span>)
<span onmouseout="hideTip(event, 'fs56', 132)" onmouseover="showTip(event, 'fs56', 132)" class="t">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs57', 133)" onmouseover="showTip(event, 'fs57', 133)" class="i">CustomExpanders</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs58', 134)" onmouseover="showTip(event, 'fs58', 134)" class="f">Add</span>(<span onmouseout="hideTip(event, 'fs38', 135)" onmouseover="showTip(event, 'fs38', 135)" class="i">typeof</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs36', 136)" onmouseover="showTip(event, 'fs36', 136)" class="t">JsonValue</span><span class="o">&gt;</span>, <span class="k">fun</span> <span onmouseout="hideTip(event, 'fs60', 137)" onmouseover="showTip(event, 'fs60', 137)" class="i">o</span> <span class="k">-&gt;</span>  <span onmouseout="hideTip(event, 'fs60', 138)" onmouseover="showTip(event, 'fs60', 138)" class="i">o</span> <span class="o">:?&gt;</span> <span onmouseout="hideTip(event, 'fs36', 139)" onmouseover="showTip(event, 'fs36', 139)" class="t">JsonValue</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs32', 140)" onmouseover="showTip(event, 'fs32', 140)" class="f">expander</span> <span class="s">&quot;root&quot;</span>)
</pre>
</td>
</tr>
</table>

<h1>Deedle for analysis</h1>

<p>Deedle is something like an in-memory table structure, but not quite.  The frame concept is present in other languages (R, python [Pandas], and more).  Deedle is F#'s most prevelant implementation of the data frame pattern.</p>

<p>Data frames allow very quick manipulation of data once they are setup.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs61', 141)" onmouseover="showTip(event, 'fs61', 141)" class="i">dataFrame</span> <span class="o">=</span>
    [<span class="k">for</span> <span onmouseout="hideTip(event, 'fs62', 142)" onmouseover="showTip(event, 'fs62', 142)" class="i">c</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs25', 143)" onmouseover="showTip(event, 'fs25', 143)" class="i">candidateDetails</span>
      <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 144)" onmouseover="showTip(event, 'fs19', 144)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 145)" onmouseover="showTip(event, 'fs26', 145)" class="f">collect</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs27', 146)" onmouseover="showTip(event, 'fs27', 146)" class="i">c</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs27', 147)" onmouseover="showTip(event, 'fs27', 147)" class="i">c</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs28', 148)" onmouseover="showTip(event, 'fs28', 148)" class="i">Results</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs63', 149)" onmouseover="showTip(event, 'fs63', 149)" class="f">series</span> [<span class="s">&quot;Candidate&quot;</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs62', 150)" onmouseover="showTip(event, 'fs62', 150)" class="i">c</span>] ]
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs56', 151)" onmouseover="showTip(event, 'fs56', 151)" class="t">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs64', 152)" onmouseover="showTip(event, 'fs64', 152)" class="f">ofRowsOrdinal</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs56', 153)" onmouseover="showTip(event, 'fs56', 153)" class="t">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs65', 154)" onmouseover="showTip(event, 'fs65', 154)" class="f">expandAllCols</span> <span class="n">10</span>
</pre>
</td>
</tr>
</table>

<p>Group information by parties</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs66', 155)" onmouseover="showTip(event, 'fs66', 155)" class="i">parties</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs61', 156)" onmouseover="showTip(event, 'fs61', 156)" class="i">dataFrame</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs56', 157)" onmouseover="showTip(event, 'fs56', 157)" class="t">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs67', 158)" onmouseover="showTip(event, 'fs67', 158)" class="f">groupRowsByString</span> <span class="s">&quot;Candidate.party&quot;</span>
</pre>
</td>
</tr>
</table>

<p>Get the number of candidates for each party</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs68', 159)" onmouseover="showTip(event, 'fs68', 159)" class="i">numberOfCandidates</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs66', 160)" onmouseover="showTip(event, 'fs66', 160)" class="i">parties</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs56', 161)" onmouseover="showTip(event, 'fs56', 161)" class="t">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs69', 162)" onmouseover="showTip(event, 'fs69', 162)" class="f">nest</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs70', 163)" onmouseover="showTip(event, 'fs70', 163)" class="t">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs71', 164)" onmouseover="showTip(event, 'fs71', 164)" class="f">mapValues</span> <span onmouseout="hideTip(event, 'fs56', 165)" onmouseover="showTip(event, 'fs56', 165)" class="t">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs72', 166)" onmouseover="showTip(event, 'fs72', 166)" class="f">countRows</span>
</pre>
</td>
</tr>
</table>

<p>Get the sum &amp; standard deviation of various columns - this is done dynamically.  We'll focus on finances when we chart.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs73', 167)" onmouseover="showTip(event, 'fs73', 167)" class="i">partyFinancesSum</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs66', 168)" onmouseover="showTip(event, 'fs66', 168)" class="i">parties</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs56', 169)" onmouseover="showTip(event, 'fs56', 169)" class="t">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs74', 170)" onmouseover="showTip(event, 'fs74', 170)" class="f">applyLevel</span> <span onmouseout="hideTip(event, 'fs75', 171)" onmouseover="showTip(event, 'fs75', 171)" class="f">fst</span> <span onmouseout="hideTip(event, 'fs76', 172)" onmouseover="showTip(event, 'fs76', 172)" class="t">Stats</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs77', 173)" onmouseover="showTip(event, 'fs77', 173)" class="f">sum</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs78', 174)" onmouseover="showTip(event, 'fs78', 174)" class="i">partyFinancesStdDev</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs66', 175)" onmouseover="showTip(event, 'fs66', 175)" class="i">parties</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs56', 176)" onmouseover="showTip(event, 'fs56', 176)" class="t">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs74', 177)" onmouseover="showTip(event, 'fs74', 177)" class="f">applyLevel</span> <span onmouseout="hideTip(event, 'fs75', 178)" onmouseover="showTip(event, 'fs75', 178)" class="f">fst</span> <span onmouseout="hideTip(event, 'fs76', 179)" onmouseover="showTip(event, 'fs76', 179)" class="t">Stats</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs79', 180)" onmouseover="showTip(event, 'fs79', 180)" class="f">stdDev</span>
</pre>
</td>
</tr>
</table>

<h1>Charting!</h1>

<p>Chart some interesting things.
  - How many candidates did each party have in 2012?<br />
  - Which party had the most capital?
  - Which party had the most capital PER candidate?</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span onmouseout="hideTip(event, 'fs68', 181)" onmouseover="showTip(event, 'fs68', 181)" class="i">numberOfCandidates</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs80', 182)" onmouseover="showTip(event, 'fs80', 182)" class="t">Chart</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs81', 183)" onmouseover="showTip(event, 'fs81', 183)" class="f">Pie</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs80', 184)" onmouseover="showTip(event, 'fs80', 184)" class="t">Chart</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs82', 185)" onmouseover="showTip(event, 'fs82', 185)" class="f">WithLegend</span> <span class="k">true</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs80', 186)" onmouseover="showTip(event, 'fs80', 186)" class="t">Chart</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs83', 187)" onmouseover="showTip(event, 'fs83', 187)" class="f">WithTitle</span> <span class="s">&quot;Number of candidates in each party&quot;</span>
</pre>
</td>
</tr>
</table>

<p>Gives the chart
<iframe src="/chart-1" scrolling="no" seamless="seamless"></iframe></p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span onmouseout="hideTip(event, 'fs73', 188)" onmouseover="showTip(event, 'fs73', 188)" class="i">partyFinancesSum</span><span class="o">?</span><span class="i">``Candidate.total_contributions``</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs80', 189)" onmouseover="showTip(event, 'fs80', 189)" class="t">Chart</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs84', 190)" onmouseover="showTip(event, 'fs84', 190)" class="f">Bar</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs80', 191)" onmouseover="showTip(event, 'fs80', 191)" class="t">Chart</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs83', 192)" onmouseover="showTip(event, 'fs83', 192)" class="f">WithTitle</span> <span class="s">&quot;Contributions for each party&quot;</span>
</pre>
</td>
</tr>
</table>

<p>Ends up with the following: 
<iframe src="/chart-2" scrolling="no" seamless="seamless"></iframe></p>

<p>Cool property of data frames: division and other mathematical operatoins are done via index matching.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
(<span onmouseout="hideTip(event, 'fs73', 193)" onmouseover="showTip(event, 'fs73', 193)" class="i">partyFinancesSum</span><span class="o">?</span><span class="i">``Candidate.total_contributions``</span>) <span class="o">/</span>(<span onmouseout="hideTip(event, 'fs68', 194)" onmouseover="showTip(event, 'fs68', 194)" class="i">numberOfCandidates</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs70', 195)" onmouseover="showTip(event, 'fs70', 195)" class="t">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs71', 196)" onmouseover="showTip(event, 'fs71', 196)" class="f">mapValues</span> <span onmouseout="hideTip(event, 'fs46', 197)" onmouseover="showTip(event, 'fs46', 197)" class="f">float</span>) 
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs80', 198)" onmouseover="showTip(event, 'fs80', 198)" class="t">Chart</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs81', 199)" onmouseover="showTip(event, 'fs81', 199)" class="f">Pie</span> 
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs80', 200)" onmouseover="showTip(event, 'fs80', 200)" class="t">Chart</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs82', 201)" onmouseover="showTip(event, 'fs82', 201)" class="f">WithLegend</span> <span class="k">true</span> 
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs80', 202)" onmouseover="showTip(event, 'fs80', 202)" class="t">Chart</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs83', 203)" onmouseover="showTip(event, 'fs83', 203)" class="f">WithTitle</span> <span class="s">&quot;Average contributions per candidate&quot;</span>
</pre>
</td>
</tr>
</table>

<iframe src="/chart-3" scrolling="no" seamless="seamless"></iframe>
And it looks like although the republican party had more candidates, democrats raised more money.  Additionally, the WFP party (which was so small as to not even register on our first exposure) raisd a fair amount of money for their **one** candidate.

        </div>
      </div>
      <div class="span3">
        <ul id="menu" class="nav nav-list">
          <li class="nav-header">Challenges</li>
          <li><a href="/">Home</a></li>
          <li class="divider"></li>
          <li><a href="/challenge-1">Challenge 1 - Fibonacci</a></li>
          <li><a href="/challenge-2">Challenge 2 - Hashing</a></li>
          <li><a href="/challenge-3">Challenge 3 - Repeating Events</a></li>
          <li><a href="/challenge-4">Challenge 14 - Political Finances</a></li>
        </ul>
      </div>
    </div>
  </div>
</body>
</html>